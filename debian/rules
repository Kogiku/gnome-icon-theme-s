#!/usr/bin/make -f

include /usr/share/cdbs/1/rules/simple-patchsys.mk
include /usr/share/cdbs/1/rules/debhelper.mk
include /usr/share/cdbs/1/class/gnome.mk
include /usr/share/cdbs/1/rules/utils.mk
include /usr/share/gnome-pkg-tools/1/rules/uploaders.mk
-include /usr/share/gnome-pkg-tools/1/rules/gnome-get-source.mk

BITMAPS := $(shell ls | sed -rn 's/^([0-9]+)x[0-9]+$$/\1/p')

INSTDIR := $(CURDIR)/debian/gnome-icon-theme/usr/share/icons/gnome

install/gnome-icon-theme::
	mv $(INSTDIR)/scalable/places/start-here.svg $(INSTDIR)/scalable/places/gnome-foot.svg
	cp debian/debian-swirl.svg debian/swirl-foot.svg $(INSTDIR)/scalable/places/
	for i in $(BITMAPS); do \
		d=$${i}x$${i} ; \
		if [ -d $(INSTDIR)/$$d/places ]; then \
			mv $(INSTDIR)/$$d/places/start-here.png $(INSTDIR)/$$d/places/gnome-foot.png ; \
			rsvg-convert -w $$i -h $$i -o $(INSTDIR)/$$d/places/debian-swirl.png debian/debian-swirl.svg ; \
			rsvg-convert -w $$i -h $$i -o $(INSTDIR)/$$d/places/swirl-foot.png debian/swirl-foot.svg ; \
		fi ; \
	done
